<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
    --primary-bg: #0d1117;
    --secondary-bg: #161b22;
    --card-bg: #1c2128;
    --accent: #1f6feb;
    --light-accent: #58a6ff;
    --text: #f0f6fc;
    --success: #238636;
}
* { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
body { background-color: var(--primary-bg); color: var(--text); min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 15px; }
.container { width: 100%; max-width: 500px; display: flex; flex-direction: column; align-items: center; gap: 15px; }
header { text-align: center; margin-bottom: 15px; }
h1 { color: var(--light-accent); margin-bottom: 8px; font-size: 1.6rem; }
.card { background-color: var(--card-bg); border-radius: 12px; padding: 20px; width: 100%; box-shadow: 0 4px 12px rgba(0,0,0,0.3); border:1px solid #30363d; }
.btn { background-color: var(--accent); color: white; border: none; border-radius: 8px; padding: 14px; font-size:1rem; cursor:pointer; width:100%; transition:all 0.2s; box-shadow:0 2px 8px rgba(31,111,235,0.3);}
.btn:active { transform: scale(0.98); }
.instructions { background-color: var(--secondary-bg); padding: 15px; border-radius: 8px; margin-top: 15px; font-size:0.85rem; line-height:1.5; border-right:3px solid var(--accent);}
.instructions h3 { color: var(--light-accent); margin-bottom: 8px; }
.coordinates-container { display: none; flex-direction: column; gap:15px; width:100%; }
.coordinates-row { display:flex; gap:10px; width:100%; }
.coordinate-box { flex:1; background-color: var(--secondary-bg); border-radius:8px; padding:15px; text-align:center; border:1px solid #30363d;}
.coordinate-label { font-size:0.85rem; margin-bottom:8px; color: var(--light-accent);}
.coordinate-value { font-size:1rem; font-weight:bold; margin-bottom:10px; word-break:break-all; font-family:'Courier New', monospace;}
.copy-btn { background-color: var(--accent); color:white; border:none; border-radius:4px; padding:6px 10px; font-size:0.8rem; cursor:pointer; width:100%;}
.copy-btn:active { background-color: var(--light-accent); }
.location-details { background-color: var(--secondary-bg); border-radius:8px; padding:15px; width:100%; border:1px solid #30363d;}
.location-line { display:flex; align-items:center; margin-bottom:8px;}
.country-flag { font-size:1.2rem; margin-left:8px; }
.loading { display:none; flex-direction:column; align-items:center; gap:15px; margin:15px 0; }
.spinner { width:40px; height:40px; border:3px solid rgba(88,166,255,0.3); border-top:3px solid var(--light-accent); border-radius:50%; animation:spin 1s linear infinite;}
@keyframes spin { 0% { transform:rotate(0deg);} 100% { transform:rotate(360deg);} }
.app-link { background-color: var(--card-bg); border-radius:8px; padding:12px; text-align:center; margin-top:15px; width:100%; border:1px solid #30363d;}
.app-link a { color: var(--light-accent); text-decoration:none; font-size:0.9rem; display:inline-flex; align-items:center; gap:6px; padding:8px 15px; border:1px solid var(--light-accent); border-radius:6px;}
footer { margin-top:20px; text-align:center; font-size:0.75rem; color:#8b949e; width:100%; }
.hidden { display:none; }
.fade-in { animation: fadeIn 0.5s ease-in;}
@keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
</style>
</head>
<body>
<div class="container">
<header>
<h1>ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</h1>
<p>Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø®Ø·ÙˆØ· Ø§Ù„Ø·ÙˆÙ„ ÙˆØ§Ù„Ø¹Ø±Ø¶ Ø¨Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ© Ø¬Ø¯Ù‹Ø§</p>
</header>

<div class="card">
<button id="locationBtn" class="btn">ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ÙŠ Ø¨Ø¯Ù‚Ø©</button>
<div id="initialInstructions" class="instructions">
<h3>Ø§Ø°Ø§ Ù„Ù… ÙŠØ¹Ù…Ù„ Ø§Ù„Ø²Ø±:</h3>
<p>Ø§Ù†ØªÙ‚Ù„ Ù„Ù„Ø§Ø¹Ø¯Ø§Ø¯Ø§Øª > Ø§Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠÙ‡ > Ø§Ø°Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ > Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§ÙˆÙ„Ø§</p>
<p>Settings > Site settings > Location > Ask before accessing</p>
</div>

<div id="afterInstructions" class="instructions hidden">
<h3>ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</h3>
<p>Ø§Ù†Ø³Ø® Ø®Ø· Ø§Ù„Ø·ÙˆÙ„ Ùˆ Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶ Ø«Ù… Ø¶Ø¹Ù‡Ù… ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒ Ø¨Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ© Ø¬Ø¯Ù‹Ø§.</p>
</div>
</div>

<div id="loading" class="loading">
<div class="spinner"></div>
<p>Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒ...</p>
</div>

<div id="coordinatesContainer" class="coordinates-container">
<div class="coordinates-row">
<div class="coordinate-box">
<div class="coordinate-label">Ø®Ø· Ø§Ù„Ø·ÙˆÙ„</div>
<div id="longitudeValue" class="coordinate-value">--</div>
<button class="copy-btn" data-clipboard-target="#longitudeValue">Ù†Ø³Ø®</button>
</div>
<div class="coordinate-box">
<div class="coordinate-label">Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶</div>
<div id="latitudeValue" class="coordinate-value">--</div>
<button class="copy-btn" data-clipboard-target="#latitudeValue">Ù†Ø³Ø®</button>
</div>
</div>

<div class="location-details">
<div class="location-line">
<span id="countryFlag" class="country-flag"></span>
<span id="fullAddress">--</span>
</div>
<div class="location-line">
<span class="coordinate-label">Ø¯Ù‚Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹:</span>
<span id="accuracyValue">-- Ù…ØªØ±</span>
</div>
</div>
</div>

<div class="app-link">
<a href="#" id="appLink">Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ ØªØ·Ø¨ÙŠÙ‚ Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©</a>
</div>

<footer>
<p>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© &copy; 2026 - Ù…ÙˆÙ‚Ø¹ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</p>
<p>Ø®Ø§Øµ Ø¨ØªØ·Ø¨ÙŠÙ‚ Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø© Ù„Ù„Ù…Ø·ÙˆØ± Kimo</p>
</footer>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const locationBtn = document.getElementById('locationBtn');
    const loading = document.getElementById('loading');
    const coordinatesContainer = document.getElementById('coordinatesContainer');
    const initialInstructions = document.getElementById('initialInstructions');
    const afterInstructions = document.getElementById('afterInstructions');
    const longitudeValue = document.getElementById('longitudeValue');
    const latitudeValue = document.getElementById('latitudeValue');
    const fullAddress = document.getElementById('fullAddress');
    const countryFlag = document.getElementById('countryFlag');
    const accuracyValue = document.getElementById('accuracyValue');
    const appLink = document.getElementById('appLink');
    const copyButtons = document.querySelectorAll('.copy-btn');

    document.querySelectorAll('.btn, .copy-btn').forEach(button => {
        button.addEventListener('mousedown', function() { this.style.transform='scale(0.98)';});
        button.addEventListener('mouseup', function() { this.style.transform='scale(1)';});
    });

    copyButtons.forEach(button => {
        button.addEventListener('click', function(){
            const targetId = this.getAttribute('data-clipboard-target');
            const targetElement = document.querySelector(targetId);
            const textToCopy = targetElement.textContent;
            navigator.clipboard.writeText(textToCopy).then(() => {
                const originalText = this.textContent;
                this.textContent = 'ØªÙ… Ø§Ù„Ù†Ø³Ø®!';
                this.style.backgroundColor = 'var(--success)';
                setTimeout(() => {
                    this.textContent = originalText;
                    this.style.backgroundColor = 'var(--accent)';
                }, 2000);
            });
        });
    });

    locationBtn.addEventListener('click', getLocation);

    function getLocation() {
        loading.style.display = 'flex';
        coordinatesContainer.style.display = 'none';
        if(!navigator.geolocation){ alert('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø®Ø¯Ù…Ø© ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹'); loading.style.display='none'; return; }

        const desiredAccuracy = 10;
        const maxTimeMs = 25000;
        let bestPosition = null;
        let watchId = null;
        const startTime = Date.now();

        function acceptPosition(pos){
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;
            const acc = pos.coords.accuracy;

            if(!bestPosition || acc < bestPosition.coords.accuracy){ bestPosition = pos; }

            if(acc <= desiredAccuracy || (Date.now()-startTime)>=maxTimeMs){
                navigator.geolocation.clearWatch(watchId);
                showPosition(bestPosition);
            }
        }

        function errorHandler(err){
            navigator.geolocation.clearWatch(watchId);
            loading.style.display='none';
            switch(err.code){
                case err.PERMISSION_DENIED: alert('ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø¥Ø°Ù† Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹.'); break;
                case err.POSITION_UNAVAILABLE: alert('Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…ØªØ§Ø­Ø©.'); break;
                case err.TIMEOUT: alert('Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø·Ù„Ø¨ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹.'); break;
                default: alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹.'); break;
            }
        }

        watchId = navigator.geolocation.watchPosition(acceptPosition,errorHandler,{
            enableHighAccuracy:true, maximumAge:0, timeout:maxTimeMs
        });

        setTimeout(()=>{
            if(watchId){ navigator.geolocation.clearWatch(watchId);
                if(bestPosition){ showPosition(bestPosition); }
                else{ loading.style.display='none'; alert('Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ Ø¨Ø¯Ù‚Ø©. Ø­Ø§ÙˆÙ„ ØªÙØ¹ÙŠÙ„ GPS Ø£Ùˆ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù„Ù…ÙƒØ§Ù† Ù…ÙØªÙˆØ­.'); }
            }
        }, maxTimeMs+500);
    }

    function showPosition(pos){
        loading.style.display='none';
        coordinatesContainer.style.display='flex';
        coordinatesContainer.classList.add('fade-in');
        initialInstructions.classList.add('hidden');
        afterInstructions.classList.remove('hidden');

        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;
        latitudeValue.textContent = lat.toFixed(6);
        longitudeValue.textContent = lon.toFixed(6);
        accuracyValue.textContent = `${Math.round(pos.coords.accuracy)} Ù…ØªØ±`;

        fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&accept-language=ar`)
        .then(response => response.json())
        .then(data => {
            if(data && data.address){
                const address = data.address;
                const city = address.city || address.town || address.village || '';
                const state = address.state || '';
                const country = address.country || '';
                fullAddress.textContent = [city,state,country].filter(Boolean).join('ØŒ ');
                const countryCode = (address.country_code||'UN').toUpperCase();
                countryFlag.textContent = getFlagEmoji(countryCode);
            }else{
                countryFlag.textContent='ğŸ´';
                fullAddress.textContent='Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
            }
        })
        .catch(()=>{ countryFlag.textContent='ğŸ´'; fullAddress.textContent='Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'; });
    }

    function getFlagEmoji(countryCode){
        if(countryCode==='UN') return 'ğŸ´';
        return String.fromCodePoint(...countryCode.split('').map(c=>127397+c.charCodeAt()));
    }

    appLink.addEventListener('click', function(e){
        e.preventDefault();
        window.location.href='intent://com.Azan.world#Intent;scheme=com.Azan.world;package=com.Azan.world;end;';
    });
});
</script>
</body>
</html>
